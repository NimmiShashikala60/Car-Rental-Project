<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter&family=Poppins&family=Source+Sans+Pro:wght@300&display=swap"
          rel="stylesheet">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="assets/css/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/style.css">

    <meta name="viewport" content="width=device-width initial-scale=1">
</head>
<body>
<div class="aside">
    <div class="logo">
        <a href="#"><span>C</span>ar Rental</a>
    </div>
    <div class="navbar-toggler">
        <span></span>

    </div>
    <ul class="nav">
        <li><a href="Admin-Information.html" class="active"><i class="fa fa-user"></i>Admin Information </a><li>
        <li><a href="Daily-Summery.html" class="active"><i class="fa fa-user"></i>Daily Summary </a><li>
        <li><a href="Car-Booking.html" class="active"><i class="fa fa-car"></i>Car Booking</a><li>
        <li><a href="Car-Booking.html" class="active"><i class="fa fa-car"></i>Car Routes</a><li>
        <li><a href="User-Information.html" class="active"><i class="fa fa-user"></i>User Information </a><li>
        <li><a href="Driver-Information.html" class="active"><i class="fa fa-car"></i>Driver Information </a><li>
        <li><a href="View-Schedule.html" class="active"><i class="fa fa-admin"></i>View Schedule </a><li>
        <li><a href="Income.html" class="active"><i class="fa fa-admin"></i>Income</a><li>
    </ul>
</div>
<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center">
    <section class="w-25 h-100 p-5">
        <h4>View Schedule</h4>
        <form class="mt-2">

            <div class="mb-3">
                <label for="Vehicle.reg.num" class="form-label">Vehicle.reg.num:</label>
                <input type="text" class="form-control" id="Vehicle.reg.num">
            </div>
            <div class="mb-3">
                <label for="VehicleType" class="form-label">Vehicle Type:</label>
                <input type="text" class="form-control" id="VehicleType">
            </div>
            <div class="mb-3">
                <label for="VehicleBrand" class="form-label">Vehicle Brand:</label>
                <input type="text" class="form-control" id="VehicleBrand" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="Number.of.passenger" class="form-label">Number.of.passenger:</label>
                <input type="text" class="form-control" id="Number.of.passenger" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="UserId" class="form-label">User Id:</label>
                <input type="text" class="form-control" id="UserId" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="UserContact" class="form-label">User Contact:</label>
                <input type="text" class="form-control" id="UserContact" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="Date" class="form-label">Date:</label>
                <input type="date" class="form-control" id="Date" aria-describedby="emailHelp">
            </div>
            <button type="submit" class="btn btn-primary" id="Save">Save</button>
            <button type="submit" class="btn btn-primary" id="Update">Update</button>
            <button type="submit" class="btn btn-primary" id="GetAll">GetAll</button>
            <button type="submit" class="btn btn-primary" id="Delete">Delete</button>
        </form>

    </section>

    <section class="w-75">
        <table class="table">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Vehicle.reg.num</th>
                <th scope="col">Vehicle Type</th>
                <th scope="col">Vehicle Brand</th>
                <th scope="col">Number.of.passenger</th>
                <th scope="col">User Id</th>
                <th scope="col">User Contact</th>
                <th scope="col">Date</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">1</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">2</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">3</th>
                <td colspan="2"></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">4</th>
                <td colspan="2"></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            </tbody>
        </table>
    </section>

</div>
</div>
<script src="assets/js/js/bootstrap.min.js"></script>
<script src="assets/jquery-3.6.1.min.js"></script>

<script>
    let baseUrl="http://localhost:8080/car_rental/";


    $("#ViewSchedule").on("click", function () {
        var formData = $("#ViewSchedule").serialize();
        $.ajax({
            url: baseUrl + "customer",
            method: "post",
            data: formData,
            dataType: "json",
            success: function (res) {
                alert(res.message);
                loadViewSchedule();
            },

            error: function (error) {
                var jsObject = JSON.parse(error.responseText);
                alert(jsObject.message);
            }
        });
    });


    $("#btnGetAll").click(function () {
        //send ajax request to the customer servlet
        loadViewSchedule();
    });
    $("#btnScheduleDelete").click(function () {
        let id = $("#txtVehicle.reg.num").val();
        $.ajax({
            url: baseURL+"customer?id=" + num + "",
            method: "delete",
            dataType:"json",
            success: function (resp) {
                alert(resp.message);
                loadAllViewSchedule();
            },
            error:function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });
    $("#btnUpdate").click(function () {

        let VehicleRegNum = $("#txtVehicleRegNum").val();
        let VehicleType = $("#txtVehicleType").val();
        let VehicleBrand = $("#txtVehicleBrand").val();
        let NumberOfPassenger = $("#txtNumberOfPassenger").val();
        let UserId = $("#txtUserId").val();
        let UserContact = $("#txtUserContact").val();
        let Date = $("#txtDate").val();


        var Schedule = {
            vehicleregnum: VehicleRegNum,
            vehicletype: VehicleType,
            vehiclebrand: VehicleBrand,
            numberofpassenger: NumberOfPassenger,
            userid: UserId,
            usercontact: UserContact,
            date: Date,
        }

        $.ajax({
            url: baseURL+'customer',
            method: 'put',
            contentType:"application/json",
            data:JSON.stringify(Schedule),
            dataType:"json",
            success: function (res) {
                alert(res.message);
                loadAllSchedule();
            },
            error:function (error){
                let cause= JSON.parse(error.responseText).message;
                alert(cause);
            }

        });
    });
    function loadAllSchedule() {
        $("#tblSchedule").empty();
        $.ajax({
            url: baseURL+"customer",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                for (let shc of resp.data) {
                    var row = '<tr><td>' + shc.vehicleregnum + '</td><td>' + shc.vehicletype + '</td><td>' + shc.vehiclebrand + '</td><td>' + shc.numberofpassenger + '</td></tr>'+ shc.userid + '</td></tr>'+ shc.contact + '</td></tr>'+ shc.date + '</td></tr>';
                    $("#tblAdmin").append(row);
                }
                bindRowClickEvents();
                setTextFieldValues("","","","");
                $("#txtSchedule").focus();
            }
        });

    }
    function bindRowClickEvents() {
        $("#tblSchedule>tr").click(function () {
            let vehicleregnum = $(this).children(":eq(0)").text();
            let vehicletype = $(this).children(":eq(1)").text();
            let vehiclebrand = $(this).children(":eq(2)").text();
            let numberofpassenger = $(this).children(":eq(3)").text();
            let userid = $(this).children(":eq(4)").text();
            let usercontact = $(this).children(":eq(5)").text();
            let date = $(this).children(":eq(6)").text();



            $('#txtVehicleRegNum').val(vehicleregnum);
            $('#txtVehicleType').val(vehicletype);
            $('#txtVehicleBrand').val(vehiclebrand);
            $('#txtNumberOfPassenger').val(numberofpassenger);
            $('#txtUserid').val(userid);
            $('#txtUserContact').val(usercontact);
            $('#txtDate').val(date);

        });
    }
    function setTextFieldValues(vehicleregnum, vehicletype, vehclebrand, numberofpassenger, userid, usercontact, date) {
        $("#txtVehicleRegNum").val(vehicleregnum);
        $("#txtVehicleType").val(vehicletype);
        $("#txtVehicleBrand").val(vehclebrand);
        $('#txtNumberOfPassenger').val(numberofpassenger);
        $('#txtUserId').val(userid);
        $('#txtUserContact').val(usercontact);
        $('#txtDate').val(date);
    }











</script>
</body>
</html>