<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>POS | Customers</title>

        <!-- Font -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter&family=Poppins&family=Source+Sans+Pro:wght@300&display=swap"
              rel="stylesheet">

        <!-- Bootstrap -->
        <link rel="stylesheet" href="assets/css/css/bootstrap.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">

        <link rel="stylesheet" href="assets/css/style.css">

        <meta name="viewport" content="width=device-width initial-scale=1">

    </head>
</html>
<body>
<div class="main-container">
    <div class="aside">
        <div class="logo">
            <a href="#"><span>C</span>ar Rental</a>
        </div>
        <div class="navbar-toggler">
            <span></span>

        </div>
        <ul class="nav">
            <li><a href="Admin-Information.html" class="active"><i class="fa fa-user"></i>Admin Information </a><li>
            <li><a href="Daily-Summery.html" class="active"><i class="fa fa-user"></i>Daily Summary </a><li>
            <li><a href="Car-Booking.html" class="active"><i class="fa fa-car"></i>Car Booking</a><li>
            <li><a href="Car-Routes.html" class="active"><i class="fa fa-car"></i>Car Routes</a><li>
            <li><a href="User-Information.html" class="active"><i class="fa fa-user"></i>User Information </a><li>
            <li><a href="Driver-Information.html" class="active"><i class="fa fa-car"></i>Driver Information </a><li>
            <li><a href="View-Schedule.html" class="active"><i class="fa fa-admin"></i>View Schedule </a><li>
            <li><a href="Income.html" class="active"><i class="fa fa-admin"></i>Income</a><li>
        </ul>
    </div>
    <div class="main-content d-flex w-100 justify-content-between align-items-center">
        <section class="w-50 h-100 p-5">
            <h4>Admin Information</h4>
            <form class="mt-2">
                <div class="mb-3">
                    <label for="AdminId" class="form-label">Admin Id</label>
                    <input type="text" class="form-control" name="AdminId" id="AdminId" aria-describedby="emailHelp">
                </div>
                <div class="mb-3">
                    <label for="AdminName" class="form-label">Admin Name</label>
                    <input type="text" class="form-control" name="AdminName" id="AdminName">
                </div>
                <div class="mb-3">
                    <label for="AdminEmail" class="form-label">Admin Email</label>
                    <input type="email" class="form-control" name="AdminEmail" id="AdminEmail" aria-describedby="emailHelp">
                </div>
                <div class="mb-3">
                    <label for="ContactNumber" class="form-label">Contact Number</label>
                    <input type="text" class="form-control" name="ContactNumber" id="ContactNumber" aria-describedby="emailHelp">
                </div>
                <section class="d-flex gap-2">
                    <button type="button" class="btn btn-primary" id="Save">Save</button>
                    <button type="submit" class="btn btn-primary" id="Update">Update</button>
                    <button type="submit" class="btn btn-primary" id="GetAll">GetAll</button>
                    <button type="submit" class="btn btn-primary" id="Delete">Delete</button>
                </section>
            </form>

        </section>

        <section class="w-75">
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Admin Id</th>
                    <th scope="col">Admin Name</th>
                    <th scope="col">Admin Email</th>
                    <th scope="col">Contact Number</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">1</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th scope="row">2</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th scope="row">3</th>
                    <td colspan="2"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <th scope="row">4</th>
                    <td colspan="2"></td>
                    <td></td>
                    <td></td>
                </tr>
                </tbody>
            </table>
        </section>

    </div>

</div>
<script src="assets/js/js/bootstrap.min.js"></script>
<script src="assets/jquery-3.6.1.min.js"></script>

<script>
    let baseUrl="http://localhost:8080/car_rental/";
    loadAllAdmin();


   $("#AdminInformation").on("click", function () {
       var formData = $("#AdminInformation").serialize();
       $.ajax({
           url: baseUrl + "customer",
           method: "post",
           data: formData,
           dataType: "json",
           success: function (res) {
               alert(res.message);
               loadAllAdmin();
           },

           error: function (error) {
               var jsObject = JSON.parse(error.responseText);
               alert(jsObject.message);
           }
       });
   });


    $("#btnGetAll").click(function () {
        //send ajax request to the customer servlet
        loadAllAdmin();
    });
    $("#btnAdminDelete").click(function () {
        let id = $("#txtAdminID").val();
        $.ajax({
            url: baseURL+"customer?id=" + id + "",
            method: "delete",
            dataType:"json",
            success: function (resp) {
                alert(resp.message);
                loadAllAdmin();
            },
            error:function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });
    $("#btnUpdate").click(function () {

        let AdminID = $("#txtAdminID").val();
        let AdminName = $("#txtAdminName").val();
        let AdminEmail = $("#txtAdminEmail").val();
        let AdminContact = $("#txtAdminContact").val();

        var Admin = {
            id: AdminID,
            name: AdminName,
            email: AdminEmail,
            contact: AdminContact,
        }

        $.ajax({
            url: baseURL+'customer',
            method: 'put',
            contentType:"application/json",
            data:JSON.stringify(Admin),
            dataType:"json",
            success: function (res) {
                alert(res.message);
                loadAllAdmin();
            },
            error:function (error){
                let cause= JSON.parse(error.responseText).message;
                alert(cause);
            }

        });
    });
    function loadAllAdmin() {
        $("#tblAdmin").empty();
        $.ajax({
            url: baseUrl+"customer",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                for (let adm of resp.data) {
                    var row = '<tr><td>' + adm.id + '</td><td>' + adm.name + '</td><td>' + adm.email + '</td><td>' + adm.contact + '</td></tr>';
                    $("#tblAdmin").append(row);
                }
                bindRowClickEvents();
                setTextFieldValues("","","","");
                $("#txtAdmin").focus();
            }
        });

    }
    function bindRowClickEvents() {
        $("#tblAdmin>tr").click(function () {
            let id = $(this).children(":eq(0)").text();
            let name = $(this).children(":eq(1)").text();
            let email = $(this).children(":eq(2)").text();
            let contact = $(this).children(":eq(3)").text();

            $('#txtAdminID').val(id);
            $('#txtAdminName').val(name);
            $('#txtAdminEmail').val(email);
            $('#txtAdminContact').val(contact);

        });
    }
    function setTextFieldValues(id, name, email, contact) {
        $("#txtAdminID").val(id);
        $("#txtAdminName").val(name);
        $("#txtAdminEmail").val(email);
        $("#txtAdminContact").val(contact);
    }

    $("#Save").on("click",function () {

        $.ajax({
            url:baseUrl+"admin",
            method:"post",
            // dataType:"json",
            // contentType: "application/json",
            success:function () {
                alert("saved")
            }
        })

    })

</script>
</body>
</html>