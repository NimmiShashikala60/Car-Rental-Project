<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter&family=Poppins&family=Source+Sans+Pro:wght@300&display=swap"
          rel="stylesheet">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="assets/css/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/style.css">

    <meta name="viewport" content="width=device-width initial-scale=1">
</head>
<body>
<div class="aside">
    <div class="logo">
        <a href="#"><span>C</span>ar Rental</a>
    </div>
    <div class="navbar-toggler">
        <span></span>

    </div>
    <ul class="nav">
        <li><a href="Admin-Information.html" class="active"><i class="fa fa-user"></i>Admin Information </a><li>
        <li><a href="Daily-Summery.html" class="active"><i class="fa fa-user"></i>Daily Summary </a><li>
        <li><a href="Car-Booking.html" class="active"><i class="fa fa-car"></i>Car Booking</a><li>
        <li><a href="Car-Routes.html" class="active"><i class="fa fa-car"></i>Car Routes</a><li>
        <li><a href="User-Information.html" class="active"><i class="fa fa-user"></i>User Information </a><li>
        <li><a href="Driver-Information.html" class="active"><i class="fa fa-car"></i>Driver Information </a><li>
        <li><a href="View-Schedule.html" class="active"><i class="fa fa-admin"></i>View Schedule </a><li>
        <li><a href="Income.html" class="active"><i class="fa fa-admin"></i>Income</a><li>


    </ul>
</div>
<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center">
    <section class="w-25 h-100 p-5">
        <h4>Driver Information</h4>
        <form class="mt-2">
            <div class="mb-3">
                <label for="DriverId" class="form-label">Driver Id:</label>
                <input type="text" class="form-control" id="Driver Id">
            </div>
            <div class="mb-3">
                <label for="DriverName" class="form-label">Driver Name:</label>
                <input type="text" class="form-control" id="DriverName">
            </div>
            <div class="mb-3">
                <label for="DriverAddress" class="form-label">Driver Address:</label>
                <input type="text" class="form-control" id="DriverAddress" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="DriverContact" class="form-label">Driver Contact:</label>
                <input type="text" class="form-control" id="DriverContact" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="DriverSalary" class="form-label">Driver Salary:</label>
                <input type="text" class="form-control" id="DriverSalary" aria-describedby="emailHelp">
            </div>
            <section class="d-flex gap-2">
            <button type="submit" class="btn btn-primary" id="Save">Save</button>
            <button type="submit" class="btn btn-primary" id="Update">Update</button>
            <button type="submit" class="btn btn-primary" id="GetAll">GetAll</button>
            <button type="submit" class="btn btn-primary" id="Delete">Delete</button>
            </section>
        </form>

    </section>

    <section class="w-75">
        <table class="table">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Driver Id</th>
                <th scope="col">Driver Name</th>
                <th scope="col">Driver Address</th>
                <th scope="col">Driver Contact</th>
                <th scope="col">Driver Salary</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">1</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">2</th>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">3</th>
                <td colspan="2"></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">4</th>
                <td colspan="2"></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            </tbody>
        </table>
    </section>

</div>
</div>
<script src="assets/js/js/bootstrap.min.js"></script>
<script src="assets/jquery-3.6.1.min.js"></script>
<script>
   let baseUrl="http://localhost:8080/car_rental/";
   loadAllDriver()


   $("#DriverInformation").on("click", function () {
       var formData = $("#DriverInformation").serialize();
       $.ajax({
           url: baseUrl + "customer",
           method: "post",
           data: formData,
           dataType: "json",
           success: function (res) {
               alert(res.message);
               loadAllDriver();
           },

           error: function (error) {
               var jsObject = JSON.parse(error.responseText);
               alert(jsObject.message);
           }
       });
   });


   $("#btnGetAll").click(function () {
       //send ajax request to the customer servlet
       loadAllAdmin();
   });
   $("#btnDriverDelete").click(function () {
       let id = $("#txtDriverID").val();
       $.ajax({
           url: baseURL+"customer?id=" + id + "",
           method: "delete",
           dataType:"json",
           success: function (resp) {
               alert(resp.message);
               loadAllDriver();
           },
           error:function (error){
               alert(JSON.parse(error.responseText).message);
           }
       });
   });
   $("#btnUpdate").click(function () {

       let DriverID = $("#txtDriverID").val();
       let DriverName = $("#txtDriverName").val();
       let DriverAddress = $("#txtDriverAddress").val();
       let DriverContact = $("#txtDriverContact").val();
       let DriverSalary = $("#txtDriverSalary").val();

       var Driver = {
           id: DriverID,
           name: DriverName,
           email: DriverAddress,
           contact: DriverContact,
           salary: DriverSalary,
       }

       $.ajax({
           url: baseURL+'customer',
           method: 'put',
           contentType:"application/json",
           data:JSON.stringify(Driver),
           dataType:"json",
           success: function (res) {
               alert(res.message);
               loadAllDriver();
           },
           error:function (error){
               let cause= JSON.parse(error.responseText).message;
               alert(cause);
           }

       });
   });
   function loadAllDriver() {
       $("#tblDriver").empty();
       $.ajax({
           url: baseURL+"customer",
           dataType: "json",
           success: function (resp) {
               console.log(resp);
               for (let dri of resp.data) {
                   var row = '<tr><td>' + dri.id + '</td><td>' + dri.name + '</td><td>' + dri.address + '</td><td>' + dri.contact + '</td></tr>'+ dri.salary + '</td></tr>';
                   $("#tblDriver").append(row);
               }
               bindRowClickEvents();
               setTextFieldValues("","","","");
               $("#txtDriver").focus();
           }
       });

   }
   function bindRowClickEvents() {
       $("#tblDriver>tr").click(function () {
           let id = $(this).children(":eq(0)").text();
           let name = $(this).children(":eq(1)").text();
           let address = $(this).children(":eq(2)").text();
           let contact = $(this).children(":eq(3)").text();
           let salary = $(this).children(":eq(4)").text();

           $('#txtDriverID').val(id);
           $('#txtDriverName').val(name);
           $('#txtDriverAddress').val(address);
           $('#txtDriverContact').val(contact);
           $('#txtDriverSalary').val(salary);

       });
   }
   function setTextFieldValues(id, name, address, contact, salary) {
       $("#txtAdminID").val(id);
       $("#txtDriverName").val(name);
       $("#txtDriverAddress").val(address);
       $("#txtDriverContact").val(contact);
       $("#txtDriverSalary").val(salary);
   }

</script>
</body>
</html>