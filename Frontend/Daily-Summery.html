<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter&family=Poppins&family=Source+Sans+Pro:wght@300&display=swap"
        rel="stylesheet">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="assets/css/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">

  <link rel="stylesheet" href="assets/css/style.css">

  <meta name="viewport" content="width=device-width initial-scale=1">
</head>
<body>
<div class="aside">
  <div class="logo">
    <a href="#"><span>C</span>ar Rental</a>
  </div>
  <div class="navbar-toggler">
    <span></span>

  </div>
  <ul class="nav">
    <li><a href="Admin-Information.html" class="active"><i class="fa fa-user"></i>Admin Information </a><li>
    <li><a href="Daily-Summery.html" class="active"><i class="fa fa-user"></i>Daily Summary </a><li>
    <li><a href="Car-Booking.html" class="active"><i class="fa fa-car"></i>Car Booking</a><li>
    <li><a href="Car-Routes.html" class="active"><i class="fa fa-car"></i>Car Routes</a><li>
    <li><a href="User-Information.html" class="active"><i class="fa fa-user"></i>User Information </a><li>
    <li><a href="Driver-Information.html" class="active"><i class="fa fa-car"></i>Driver Information </a><li>
    <li><a href="View-Schedule.html" class="active"><i class="fa fa-admin"></i>View Schedule </a><li>
    <li><a href="Income.html" class="active"><i class="fa fa-admin"></i>Income</a><li>

  </ul>
</div>

<div class="main-content d-flex w-100 justify-content-between align-items-center"></div>
<div class="main-content d-flex w-100 justify-content-between align-items-center">
  <section class="w-25 h-100 p-5">
    <h4>Daily Summery</h4>
    <form class="mt-2">
      <div class="mb-3">
        <label for="RegisteredUsers" class="form-label">Registered Users:</label>
        <input type="text" class="form-control" id="RegisteredUsers">
      </div>
      <div class="mb-3">
        <label for="MaintenceCar" class="form-label">Maintence Car:</label>
        <input type="text" class="form-control" id="MaintenceCar">
      </div>
      <div class="mb-3">
        <label for="BookingCar" class="form-label">Booking Cars:</label>
        <input type="text" class="form-control" id="BookingCar" aria-describedby="emailHelp">
      </div>
      <div class="mb-3">
        <label for="Occupied" class="form-label">Occupied:</label>
        <input type="text" class="form-control" id="Occupied" aria-describedby="emailHelp">
      </div>
      <div class="mb-3">
        <label for="ActiveDay" class="form-label">Active Day:</label>
        <input type="text" class="form-control" id="ActiveDay" aria-describedby="emailHelp">
      </div>
      <div class="mb-3">
        <label for="ReservedCars" class="form-label">Reserved Cars:</label>
        <input type="text" class="form-control" id="ReservedCars" aria-describedby="emailHelp">
      </div>
      <section class="d-flex gap-2">
      <button type="submit" class="btn btn-primary" id="Save">Save</button>
      <button type="submit" class="btn btn-primary" id="Update">Update</button>
      <button type="submit" class="btn btn-primary" id="GetAll">GetAll</button>
      <button type="submit" class="btn btn-primary" id="Delete">Delete</button>
      </section>
    </form>

  </section>

  <section class="w-75">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Registered Users</th>
        <th scope="col">Maintence Car</th>
        <th scope="col">Booking Cars</th>
        <th scope="col">Occupied</th>
        <th scope="col">Active Day</th>
        <th scope="col">Reserved Car Reg Num </th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <th scope="row">1</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <th scope="row">2</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <th scope="row">3</th>
        <td colspan="2"></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <th scope="row">4</th>
        <td colspan="2"></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      </tbody>
    </table>
  </section>

</div>
</div>
<script src="assets/js/js/bootstrap.min.js"></script>
<script src="assets/jquery-3.6.1.min.js"></script>

<script>
  let baseUrl="http://localhost:8080/car_rental/";

  $("#DailySummery").on("click", function () {
    var formData = $("#DailySummery").serialize();
    $.ajax({
      url: baseUrl + "customer",
      method: "post",
      data: formData,
      dataType: "json",
      success: function (res) {
        alert(res.message);
        loadAllSummery();
      },

      error: function (error) {
        var jsObject = JSON.parse(error.responseText);
        alert(jsObject.message);
      }
    });
  });


  $("#btnGetAll").click(function () {
    //send ajax request to the customer servlet
    loadAllSummery();
  });
  $("#btnDelete").click(function () {
    let id = $("#txtRegUsers").val();
    $.ajax({
      url: baseURL+"customer?id=" + id + "",
      method: "delete",
      dataType:"json",
      success: function (resp) {
        alert(resp.message);
        loadAllSummery();
      },
      error:function (error){
        alert(JSON.parse(error.responseText).message);
      }
    });
  });
  $("#btnUpdate").click(function () {

    let RegisteredUsers = $("#txtRegisteredUsers").val();
    let MaintenceCar = $("#txtMaintenceCar").val();
    let BookingCars = $("#txtBookingCars").val();
    let Occupied = $("#txtOccupied").val();
    let ActiveDay = $("#txtActiveDay").val();
    let ReservedCarRegNum = $("#txtReservedCarRegNum").val();

    var Summery = {
      regnumUsers: RegisteredUsers,
      maintence: MaintenceCar,
      booking: BookingCars,
      occupied: Occupied,
      activeday: ActiveDay,
      reservedcarregnum: ReservedCarRegNum,
    }

    $.ajax({
      url: baseURL+'customer',
      method: 'put',
      contentType:"application/json",
      data:JSON.stringify(Summery),
      dataType:"json",
      success: function (res) {
        alert(res.message);
        loadAllSummary();
      },
      error:function (error){
        let cause= JSON.parse(error.responseText).message;
        alert(cause);
      }

    });
  });
  function loadAllSummery() {
    $("#tblSummery").empty();
    $.ajax({
      url: baseUrl+"customer",
      dataType: "json",
      success: function (resp) {
        console.log(resp);
        for (let sum of resp.data) {
          var row = '<tr><td>' + sum.regnumUsers + '</td><td>' + sum.maintence + '</td><td>' + sum.booking + '</td><td>' + sum.occupied + '</td></tr>'+ sum.activeday + '</td></tr>'+ adm.reservedcarregnum + '</td></tr>';
          $("#tblSummery").append(row);
        }
        bindRowClickEvents();
        setTextFieldValues("","","","","","");
        $("#txtSummery").focus();
      }
    });

  }
  function bindRowClickEvents() {
    $("#tblSummery>tr").click(function () {
      let regnumUsers = $(this).children(":eq(0)").text();
      let maintence = $(this).children(":eq(1)").text();
      let booking = $(this).children(":eq(2)").text();
      let occupied = $(this).children(":eq(3)").text();
      let activeday = $(this).children(":eq(4)").text();
      let reservedregnumcars = $(this).children(":eq(5)").text();

      $('#txtRegNumUsers').val(regnumUsers);
      $('#txtMaintence').val(maintence);
      $('#txtBooking').val(booking);
      $('#txtOccupied').val(occupied);
      $('#txtActiveDay').val(activeday);
      $('#txtReservedRegNumCars').val(reservedregnumcars);

    });
  }
  function setTextFieldValues(regnumusers, maintence, booking, occupied, activeday, reservedregnumcars) {
    $("#txtRegNumUsers").val(regnumusers);
    $("#txtMaintence").val(maintence);
    $("#txtBooking").val(booking);
    $("#txtOccupied").val(occupied);
    $("#txtActiveDay").val(activeday);
    $("#txtReservedRegNumCars").val(reservedregnumcars);
  }

  $("#Save").on("click",function () {

    $.ajax({
      url:baseUrl+"admin",
      method:"post",
      // dataType:"json",
      // contentType: "application/json",
      success:function () {
        alert("saved")
      }
    })

  })











</script>
</body>
</html>